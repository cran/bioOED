<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Alberto Garre, Jose Lucas Peñalver-Soto, Pablo S. Fernandez, Jose A. Egea" />

<meta name="date" content="2019-08-07" />

<title>bioOED: Optimum Experiment Design for Microbial Inactivation. Dynamic inactivation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">bioOED: Optimum Experiment Design for Microbial Inactivation. Dynamic inactivation</h1>
<h4 class="author">Alberto Garre, Jose Lucas Peñalver-Soto, Pablo S. Fernandez, Jose A. Egea</h4>
<h4 class="date">2019-08-07</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The mathematical models commonly used for the description of microbial inactivation contain parameters whose exact value, at the time, cannot be analytically determined. Hence, they have to be estimated using experiments. This type of procedures do not provide an exact value of the model parameters. Instead, they estimate their probability distribution.</p>
<p>The level of uncertainty strongly depends on the experiment performed. For instance, Grijspeerd and Vanrrolleghem (1999) are able to half the estimated standard deviation of the model parameters for microbial growth using an optimum experiment design. This results in a more accurate description of the process.</p>
<p>The R-package <strong>bioOED</strong> implements functions for the design of optimum experiments, as well as for the calculation of local sensitivities, of microbial inactivation processes. This package can be downloaded form the Comprehensive R Archive Network (CRAN). Once installed, it can be loaded as</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(bioOED)</a></code></pre></div>
<p><strong>bioOED</strong> adds the following functions to the namespace:</p>
<ul>
<li><em>sensitivity_inactivation()</em>: calculates the local sensitivity functions of the output variable for a given set of nominal model parameters.</li>
<li><em>calculate_pars_correlation()</em>: calculates the correlation between the sensitivity functions of the model parameters (i.e. the structural identificability) for a set of nominal model parameters.</li>
<li><em>calculate_FIM()</em>: calculates the Fisher Information Matrix (FIM).</li>
<li><em>optimize_refTemp()</em>: finds the reference temperature which optimizes the structural identificability of the model.</li>
<li><em>inactivation_OED()</em>: Designs an optimum experiment based on a given measurement of the FIM.</li>
<li><em>inactivation_OED_penalty()</em>: Similar to <em>inactivation_OED()</em>, although including a penalty term which penalizes measurements closer than a given threshold.</li>
</ul>
<p>The simulations of microbial inactivation performed by <strong>bioOED</strong> are based on the functions implemented in the <strong>bioinactivation</strong> (Garre et al., 2016) package. Hence, only the inactivation models implemented in this package (Bigelow, Peleg, Mafart and Geeraerd) are available in <strong>bioOED</strong>. The calculation of local sensitivities is based on the features implemented in the <strong>FME</strong> package (Soetaert et al., 2010).</p>
</div>
<div id="fisher-information-matrix" class="section level2">
<h2>Fisher Information Matrix</h2>
<p>The Fisher Information Matrix (<span class="math inline">\(FIM\)</span>) for a variable <span class="math inline">\(y\)</span> which depends on a vector of parameters (<span class="math inline">\(\theta\)</span>) at a series of time points (<span class="math inline">\(t_i\)</span>) is defined by the following equation:</p>
<p><span class="math display">\[
    FIM = \sum_i \left( \frac{\partial y}{\partial \theta} \left( t_i \right) \right)^T \cdot Q_i \cdot \left( \frac{\partial y}{\partial \theta} \left( t_i \right) \right)
\]</span></p>
<p>where <span class="math inline">\(Q_i\)</span> is a matrix of weights. In this document, <span class="math inline">\(Q_i\)</span> will be considered as the identity matrix.</p>
<p>The FIM is relevant for the OED because its inverse is an estimator of the covariance matrix of the error. Hence, an OED can be made by optimizing certain measurements of the FIM. <strong>bioOED</strong> implements two of this criteria: D and modified E. The D-criterion consists on the maximization of the determinant of the FIM. It is equivalent to the minimization of the volume of the confidence ellipsoids. The modified E criterion is based on the minimization of the ratio between the maximum and minimum eigenvalue of the FIM (<span class="math inline">\(\mathrm{abs} \frac{\lambda_{max}}{\lambda_{min}}\)</span>).</p>
</div>
<div id="calculation-of-local-sensitivities" class="section level2">
<h2>Calculation of local sensitivities</h2>
<p>Local sensitivities (<span class="math inline">\(S_{ij}\)</span>) play a key role on Optimum Experiment Design. These functions quantify that variation of the output variable (<span class="math inline">\(y_i\)</span>) caused by a unitary variation of the model parameter (<span class="math inline">\(\theta_j\)</span>), as described in the following equation. <span class="math display">\[
    S_{ij} = \frac{\partial y_i}{\partial \theta_j}
\]</span></p>
<p>Typically, this derivative cannot be calculated in close form and one has to use numeric methods. <strong>bioOED</strong> uses the function <em>sensFun()</em> from the <strong>FME</strong> package for this purpouse, which approximates the local sensitivity functions using finite differences: <span class="math display">\[
    S_{ij}(t) \approx
    \frac{y \left( \theta + \Delta \theta \right) - y \left( \theta \right)}
    {\Delta \theta}
\]</span></p>
<p><strong>bioOED</strong> provides the function <em>sensitivity_inactivation()</em>, which allows to calculate estimate the local sensitivity functions. This function has 8 input arguments:</p>
<ul>
<li><em>inactivation_model</em></li>
<li><em>parms</em></li>
<li><em>temp_profile</em></li>
<li><em>parms_fix</em></li>
<li><em>n_times</em></li>
<li><em>varscale</em></li>
<li><em>parscale</em></li>
<li><em>sensvar</em></li>
</ul>
<p>The inactivation model to use for the calculation is defined by the character argument <em>inactivation_model</em>. It must be consistent with the requirements of the function <em>predict_inactivation</em> from the <strong>bioinactivation</strong> package. Refer to the help package of this function for more information.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">inactivation_model &lt;-<span class="st"> &quot;Bigelow&quot;</span></a></code></pre></div>
<p>The environmental conditions are defined through the data frame <em>temp_profile</em>. Its columns, named <code>time</code> and <code>temperature</code> must provide discrete values of the temperature profile. Intermediate points will be calculated by linear interpolation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">temp_profile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),</a>
<a class="sourceLine" id="cb3-2" title="2">                           <span class="dt">temperature =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">60</span>))</a></code></pre></div>
<p>The nominal values of the model parameters are provided by the arguments <code>parms</code> and <code>parms_fix</code>. Both arguments follow the same restriction as the equivalent ones for the <em>predict_inactivation()</em> function from the <strong>bioinactivation</strong> package. Note that local sensitivities will be calculated only for those parameters included in the <code>parms</code> argument.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">parms_fix &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">temp_ref =</span> <span class="fl">57.5</span>, <span class="dt">N0 =</span> <span class="fl">1e6</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">parms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">D_R =</span> <span class="fl">3.9</span>,</a>
<a class="sourceLine" id="cb4-3" title="3">           <span class="dt">z =</span> <span class="fl">4.2</span></a>
<a class="sourceLine" id="cb4-4" title="4">           )</a></code></pre></div>
<p>The local sensitivities are estimated at points uniformly distributed between the maximum and minimum values of time provided in the <em>temp_profile</em> argument. The number of points is provided by the integer argument <em>n_times</em> (100 by default).</p>
<p>The local sensitivities can be scaled using the <em>varscale</em> and <em>parscale</em> input arguments (see the help page of <em>sensFun</em> from the <strong>FME</strong> package). By default, both arguments are set to 1 (i.e. no scaling).</p>
<p>The argument <code>sensvar</code> allows choosing whether the sensitivity of the microbial count (<span class="math inline">\(N\)</span>) or its decimal logarithm (<span class="math inline">\(\log N\)</span>) with respect to the model parameters will be calculated. By default, the sensitivity of <span class="math inline">\(\log N\)</span> is calculated.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">sensitivity &lt;-<span class="st"> </span><span class="kw">sensitivity_inactivation</span>(inactivation_model,</a>
<a class="sourceLine" id="cb5-2" title="2">                                        parms, temp_profile,</a>
<a class="sourceLine" id="cb5-3" title="3">                                        parms_fix)</a></code></pre></div>
<p>The <em>sensitivity_inactivation()</em> function provides a data frame of class <code>&quot;sensFun&quot;</code> (defined in the <strong>FME</strong> package). This data frame contains the values estimated of the local sensitivities at each time point with respect to each one of the model variables.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">head</span>(sensitivity)</a></code></pre></div>
<pre><code>##           x  var          D_R             z
## 1 0.0000100 logN 0.000000e+00  0.000000e+00
## 2 0.6060606 logN 0.000000e+00 -1.691768e-07
## 3 1.2121212 logN 2.277381e-08 -3.595008e-07
## 4 1.8181818 logN 4.554761e-08 -5.921189e-07
## 5 2.4242424 logN 4.554761e-08 -8.881784e-07
## 6 3.0303030 logN 9.109522e-08 -1.205385e-06</code></pre>
<p>Moreover, it includes an S3 method for <em>plot()</em> which allows the visualization of the evolution of the local sensitivities through the experiment.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">plot</span>(sensitivity)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="structural-identificability" class="section level2">
<h2>Structural identificability</h2>
<p>Some mathematical models may be ill-defined in the sense that different combination of its model parameters may provide the same output. This is defined as structural identificability of the model. It can be calculated as the correlation between the local sensitivity functions with respect to the different functions.</p>
<p>The <strong>bioOED</strong> package implements the function <em>calculate_pars_correlation()</em> which calculates the correlation between the sensitivity function of the model, providing an indicator of its structural identificability. This function has 6 input arguments:</p>
<ul>
<li><em>inactivation_model</em></li>
<li><em>parms</em></li>
<li><em>temp_profile</em></li>
<li><em>parms_fix</em></li>
<li><em>n_times</em></li>
<li><em>sensvar</em></li>
</ul>
<p>They are defined identically to those defined for <em>sensitivity_inactivation()</em> and will not be repeated here.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">parms_fix &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">temp_ref =</span> <span class="fl">57.5</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">parms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">delta_ref =</span> <span class="fl">3.9</span>, <span class="dt">z =</span> <span class="fl">4.2</span>, <span class="dt">p =</span> <span class="dv">1</span>, <span class="dt">N0 =</span> <span class="fl">1e6</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">temp_profile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>), <span class="dt">temperature =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">60</span>))</a>
<a class="sourceLine" id="cb9-4" title="4">pars_correlation &lt;-<span class="st"> </span><span class="kw">calculate_pars_correlation</span>(<span class="st">&quot;Mafart&quot;</span>, parms,</a>
<a class="sourceLine" id="cb9-5" title="5">                                               temp_profile, parms_fix)</a></code></pre></div>
<p><em>calculate_pars_correlation()</em> provides a matrix of class <code>parCorrelation</code> containing the correlation between the sensitivity functions of the model parameters considered.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">print</span>(pars_correlation)</a></code></pre></div>
<pre><code>##             delta_ref           z           p          N0
## delta_ref  1.00000000  0.03549925 -0.98982135 -0.07864353
## z          0.03549925  1.00000000 -0.17736312  0.44558859
## p         -0.98982135 -0.17736312  1.00000000  0.01399121
## N0        -0.07864353  0.44558859  0.01399121  1.00000000
## attr(,&quot;class&quot;)
## [1] &quot;parCorrelation&quot; &quot;matrix&quot;</code></pre>
<p>This object includes an S3 method for plot, allowing to visualize the results of the calculation.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">plot</span>(pars_correlation)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="optimization-of-the-reference-temperature" class="section level2">
<h2>Optimization of the reference temperature</h2>
<p>The reference temperature can have a significant influence in the structural identificability of the model (Dolan and Mishra, 2013). The function <em>optimize_refTemp()</em> is able to calculate the reference temperature which optimizes the structural identificability of the model for a given set of nominal parameters and environmental conditions. This function has 8 input arguments:</p>
<ul>
<li><em>temp_ref0</em></li>
<li><em>lower</em></li>
<li><em>upper</em></li>
<li><em>inactivation_model</em></li>
<li><em>parms</em></li>
<li><em>temp_profile</em></li>
<li><em>parms_fix</em></li>
<li><em>n_times</em></li>
</ul>
<p>The optimization is performed using the Brent method implemented in the <em>optim()</em> function from the <strong>stats</strong> package. The numeric argument <em>temp_ref0</em> provides an initial guess for the optimization. Moreover, lower and upper bounds for the optimization are provided by the numeric arguments <em>lower</em> and <em>upper</em>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">temp_ref0 &lt;-<span class="st"> </span><span class="dv">57</span></a>
<a class="sourceLine" id="cb13-2" title="2">lower &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb13-3" title="3">upper &lt;-<span class="st"> </span><span class="dv">70</span></a></code></pre></div>
<p>The inactivation model to use for the calculation is defined through the argument <em>inactivation_model</em>. This argument has to be compatible with the equivalent one for the <em>predict_inactivation()</em> function from the <strong>bioinactivation</strong> package.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">inactivation_model &lt;-<span class="st"> &quot;Mafart&quot;</span></a></code></pre></div>
<p>The conditions of the experiment are defined through the <em>temp_profile</em> argument. It must be a data frame with columns named <code>time</code> and <code>temperature</code> providing discrete values of the temperature profile. Intermediate values are calculated by linear interpolation.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">temp_profile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),</a>
<a class="sourceLine" id="cb15-2" title="2">                           <span class="dt">temperature =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">60</span>))</a></code></pre></div>
<p>The nominal values of the model parameters are provided using the <code>parms</code> and <code>parms_fix</code> arguments. Both must be compatible with the requirements of the equivalent arguments for the <em>predict_inactivation()</em> function from the <strong>bioinactivation</strong> package. The parameters included in <code>parms_fix</code> will not be included in the calculation of the local sensitivities. Therefore, it is recommended to include in this argument those parameters which are known before performing the experiment. The D-value at the reference temperature (or <span class="math inline">\(\delta\)</span>) and the z-value must be included in <code>parms</code> (i.e. cannot be fixed.)</p>
<p>Note that the D-value at the reference temperature (or <span class="math inline">\(\delta\)</span>) depend on the reference temperature. Hence, the value provided in <code>parms</code> must be the one corresponding to the reference temperature provided in <code>temp_ref0</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">parms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">delta_ref =</span> <span class="fl">3.9</span>, <span class="dt">z =</span> <span class="fl">4.2</span>, <span class="dt">p =</span> <span class="dv">1</span>, <span class="dt">N0 =</span> <span class="fl">1e6</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">parms_fix &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>The local sensitivities are estimated at a uniformly distributed time points. The number of time points used for the calculation is defined through the <code>n_times</code> argument. By default, it is set to 100.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">optim_refTemp &lt;-<span class="st"> </span><span class="kw">optimize_refTemp</span>(temp_ref0, lower, upper,</a>
<a class="sourceLine" id="cb17-2" title="2">                                  inactivation_model, parms, temp_profile,</a>
<a class="sourceLine" id="cb17-3" title="3">                                  parms_fix)</a></code></pre></div>
<p><em>optimize_refTemp()</em> returns the object generated by the <em>optim()</em> function. The calculated optimum value of the reference temperature can be accessed in the <code>par</code> entry of this object.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">print</span>(optim_refTemp<span class="op">$</span>par)</a></code></pre></div>
<pre><code>## [1] 57.77658</code></pre>
<p>The convergence of the optimization algorithm should be checked in the <code>convergence</code> entry. If its value is different from 0, convergence was not achieved.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">print</span>(optim_refTemp<span class="op">$</span>convergence)</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="optimum-experiment-design-of-microbial-inactivation" class="section level2">
<h2>Optimum experiment design of microbial inactivation</h2>
<p>The function <em>inactivation_OED()</em> is able to generate an optimum experiment design based on the FIM for a microbial inactivation experiment. This function has 10 input arguments:</p>
<ul>
<li><em>inactivation_model</em></li>
<li><em>parms</em></li>
<li><em>temp_profile</em></li>
<li><em>parms_fix</em></li>
<li><em>n_points</em></li>
<li><em>criteria</em></li>
<li><em>n_times</em></li>
<li><em>sensvar</em></li>
<li><em>optim_algorithm</em></li>
<li><em>opts_global</em></li>
</ul>
<p>The inactivation model to use for the calculation is defined by the input argument <em>inactivation_model</em>. It must be compatible with the <em>predict_inactivation()</em> function from the <strong>bioinactivation</strong> package.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">inactivation_model &lt;-<span class="st"> &quot;Mafart&quot;</span></a></code></pre></div>
<p>The nominal values of the model parameters are provided by the arguments <code>pars</code> and <code>parms_fix</code>. Note that local sensitivities will only be calculated for the model parameters included in <code>pars</code>. Hence, those included in <code>parms_fix</code> will not be considered for the OED. They also must be compatible with <em>predict_inactivation()</em>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">parms_fix &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">temp_ref =</span> <span class="fl">57.5</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">parms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">delta_ref =</span> <span class="fl">3.9</span>,</a>
<a class="sourceLine" id="cb23-3" title="3">           <span class="dt">z =</span> <span class="fl">4.2</span>,</a>
<a class="sourceLine" id="cb23-4" title="4">           <span class="dt">p =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb23-5" title="5">           <span class="dt">N0 =</span> <span class="fl">1e6</span></a>
<a class="sourceLine" id="cb23-6" title="6">           )</a></code></pre></div>
<p>The conditions of the experiment are defined through the input argument <code>temp_profile</code>. It must be a data frame which provides discrete values of <code>time</code> and <code>temperature</code>. Intermediate values will be calculated by linear interpolation.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">temp_profile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>), <span class="dt">temperature =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">60</span>))</a></code></pre></div>
<p>The number of measurements to be taken during the experiment are defined by the argument <code>n_points</code>. It must be an integer greater than 0.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">n_points &lt;-<span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<p>The criteria for the OED is defined by the argument <code>criteria</code>. It must be a character with the value <code>&quot;D&quot;</code> or <code>&quot;E-mod&quot;</code>. By default, the D-criterion is set.</p>
<p>The local sensitivity functions are calculated at a set of discrete uniformly distributed time points. The number of points to use is defined by the argument <code>n_times</code> (100 by default).</p>
<p>The variable to target for the OED is set by the argument <code>sensvar</code>. It must be a character equal to <code>&quot;logN&quot;</code> (default) or <code>&quot;N&quot;</code>.</p>
<p>The OED can be generated using either a local or a global optimization algorithm. The selection is made using the argument <code>optim_algorithm</code>. In case it equals <code>&quot;global&quot;</code> (default) a global optimization algorithm is used. The local algorithm is used when this arguments equals <code>&quot;local&quot;</code>.</p>
<p>The global optimization algorithm used is the MEIGO algorithm from the <strong>MEIGOR</strong> package (Egea et al., 2012). By default, a global solver with a maximum of 50000 function evaluations and printout on every step is selected. This can be changed through the <code>opts_global</code> argument. For information regarding the format of this argument, refer to the help page of the <em>MEIGO()</em> function.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># opts_global &lt;- list(maxeval=1000,  local_solver=0,</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">#                     local_finish=&quot;DHC&quot;, local_iterprint=1)</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co"># global_OED &lt;- inactivation_OED(inactivation_model, parms, temp_profile,</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">#                                parms_fix, n_points, criteria = &quot;D&quot;,</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">#                                opts_global = opts_global)</span></a></code></pre></div>
<p>The function <em>inactivation_OED</em> returns a list of class <code>OEDinactivation</code>. It contains the following entries:</p>
<ul>
<li><code>optim</code>: the object returned by the optimization routine.</li>
<li><code>model</code>: inactivation model used for the simulation.</li>
<li><code>parms</code>: nominal parameters considered for the OED.</li>
<li><code>parms_fix</code>: nominal parameters not considered for the OED.</li>
<li><code>criteria</code>: optimization criteria followed.</li>
<li><code>sensvar</code>: variable targeted for the OED.</li>
<li><code>optim_algorithm</code>: optimization algorithm used.</li>
<li><code>optim_times</code>: optimum measurement times calculated.</li>
<li><code>penalty</code>: logical indicating whether a penalty function has been used.</li>
<li><code>times_min</code>: minimum time set for the penalty function.</li>
<li><code>temp_profile</code>: temperature profile of the experiment.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># print(global_OED$optim_times)</span></a></code></pre></div>
<p>The object <code>OEDinactivation</code> includes an S3 implementation which allows the visualization of the results.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># plot(global_OED)</span></a></code></pre></div>
</div>
<div id="optimum-experiment-design-including-penalty-function" class="section level2">
<h2>Optimum experiment design including penalty function</h2>
<p>The function <em>inactivation_OED</em> can generate experiment design unrealizable, with measurements too close in time. This issue is circumvented with the function <em>inactivation_OED_penalty</em> , which implements a penalty function to penalize unfeasible solutions. This function has 11 input arguments, 10 of which are identical to those defined for * inactivation_OED()*:</p>
<ul>
<li><em>inactivation_model</em></li>
<li><em>parms</em></li>
<li><em>temp_profile</em></li>
<li><em>parms_fix</em></li>
<li><em>n_points</em></li>
<li><em>time_min</em></li>
<li><em>criteria</em></li>
<li><em>n_times</em></li>
<li><em>sensvar</em></li>
<li><em>optim_algorithm</em></li>
<li><em>opts_global</em></li>
</ul>
<p>The only argument added by this function is <code>time_min</code>. It is a numeric value defining the minimum feasible time between measurements.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># time_min &lt;- 8</span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># global_OED_penalty &lt;- inactivation_OED_penalty(inactivation_model, parms,</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co">#                                                temp_profile, parms_fix,</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co">#                                                n_points, time_min,</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co">#                                                criteria = &quot;D&quot;, </span></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="co">#                                                opts_global = opts_global)</span></a></code></pre></div>
<p>The object returned by <em>inactivation_OED_penalty()</em> is identical to the one returned by <em>inactivation_OED()</em>. The newly calculated optimum design can be checked as before:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># print(global_OED_penalty$optim_times)</span></a></code></pre></div>
<p>Again, the results can be easily plotted.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># plot(global_OED_penalty)</span></a></code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Alberto Garre, Pablo S. Fernandez and Jose A. Egea (2016). bioinactivation: Simulation of Dynamic Microbial Inactivation. R package version 1.1.2. <a href="https://CRAN.R-project.org/package=bioinactivation" class="uri">https://CRAN.R-project.org/package=bioinactivation</a></p>
<p>Karline Soetaert and Thomas Petzoldt (2010). Inverse Modelling, Sensitivity and Monte Carlo Analysis in R Using Package FME. Journal of Statistical Software, 33(3), 1-28. URL <a href="http://www.jstatsoft.org/v33/i03/" class="uri">http://www.jstatsoft.org/v33/i03/</a>.</p>
<p>K. Grijspeerdt and P. Vanrolleghem (1999). Estimating the parameters of the Baranyi model for bacterial growth. Food Microbiology, 16(6), 593-605.</p>
<p>Kirk D. Dolan and Dharmendra K. Mishra (2013). Parameter Estimation in Food science. Annual revie of Food Science and Tehnology, 4, 401-422.</p>
<p>Jose A. Egea, David Enriques, Alexandre Fdez. Villaverde and Thomas Cokelaer (2012). MEIGOR: MEIGO - Metaheuristics for bioinformatics global optimization. R package version 1.0.0.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
